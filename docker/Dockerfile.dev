ARG PYTHON_VERSION=3.11.4
FROM python:${PYTHON_VERSION}

RUN apt-get update && apt-get install -y --no-install-recommends \
    make build-essential libssl-dev wget ca-certificates curl llvm git

WORKDIR /app

# Copy entire repository contents
# This is needed because package needs the ability to install itself:
COPY . .

RUN pip install poetry

# Install only "production" dependencies
RUN poetry config virtualenvs.create false && poetry install

CMD ["bash"]
